{% extends "runnerpage_base.html" %}

{% block runner_content %}

<a href="/runner/{{username_code}}?q=view-all">
  {% if user.username == runner.username %}
  View / edit runs
  {% else %}
  View all runs
  {% endif %}
</a>
<table class="table table-bordered">
  <thead>
    <tr>
      <th class="hidden-xs"></th>
      <th><i class="icon-gamepad icon-large"></i> Game</th>
      <th><i class="icon-compass icon-large"></i> Category</th>
      <th><i class="icon-star icon-large"></i> PB</th>
      <th><i class="icon-calendar icon-large"></i> Date</th>
      <th><i class="icon-flag-checkered icon-large"></i> Runs</th>
      <th><i class="icon-time icon-large"></i> Avg Time</th>
      <th><i class="icon-trophy icon-large"></i> Best Known Time</th>
    </tr>
  </thead>
  <tbody>
    {% for pb in pblist %}
    {% set outer_loop = loop %}
    <tr class="{{ outer_loop.cycle('active', '') }}">
      <td rowspan="{{pb['infolist']|length}}" class="hidden-xs">
	<center>
	  <a href="/game/{{pb['game_code']}}">
	    <img alt="" class="img-responsive lazy" style="max-height: 50px;" 
		 src="/static/boxart/__blank__.png"
		 data-original="/static/boxart/{{pb['game_code']}}.jpg">
	  </a>
	</center>
      </td>
      <td rowspan="{{pb['infolist']|length}}">
	<a href="/game/{{pb['game_code']}}">
	  {{pb['game']}}
	</a>
      </td>
      {% for info in pb['infolist'] %}
      {% if not loop.first %}
    <tr class="{{ outer_loop.cycle('active', '') }}">
      {% endif %}
      <td>{{info['category']}}</td>
      <td>
	{% if info['video'] %}<a href="{{info['video']}}">{% endif %}
	  {{info['pb_time']}}{% if info['video'] %}</a>{% endif %}
      </td>
      <td>{% if info['pb_date'] %}{{info['pb_date'].strftime( "%b %d %Y" )}}{% else %}-{% endif %}</td>
      <td>{{info['num_runs']}}</td>
      <td>{{info['avg_time']}}</td>
      <td>{% if info['bk_time'] %}
	{% if info['bk_video'] %}<a href="{{info['bk_video']}}">{% endif %}
	  {{info['bk_time']}}{% if info['bk_video'] %}</a>{% endif %} 
	by {{info['bk_runner']}} 
	{% if user.username == runner.username %}
	<a href="/game/{{pb['game_code']}}/update-bkt?c={{info['category_code']}}"><i class="icon-edit"></i></a>
	{% endif %}
	{% else %}
	{% if user.username == runner.username %}
	<a href="/game/{{pb['game_code']}}/update-bkt?c={{info['category_code']}}"><i class="icon-edit"></i></a>
	{% else %}
	-
	{% endif %}
	{% endif %}
      </td>
    </tr>
    {% endfor %}
    {% endfor %}
  </tbody>
</table>

{% endblock %}
